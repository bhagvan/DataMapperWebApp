<!DOCTYPE html>
<html>

    <head>
        <meta charset="UTF-8">
        <title>D3 line drawings</title>
        <script src="../assets/lib/d3/d3.js"></script>
        <!--<script src="https://d3js.org/d3.v4.min.js"></script>-->

        <style>
            .input-container{
                padding: 10px;
                margin: 50px;
                width:60%;
                border: 1px solid red;
            }
            .input-container div{
                margin: auto;
                display: inline-block;
            }
            .in-icon{
                float: right;

            }

            .canvas{
                border:1px solid black;
            }
        </style>
    </head>

    <body>

        <a href="https://www.dashingd3js.com/svg-paths-and-d3js">Source tutorial</a>






        <svg class="canvas" width="1000" height="500">
        <g  id="input-container">

        </g>
        <g id="output-container">
        <!--        <rect  class="output-leaf" x="420" y="20" height="50" width="100" stroke="blue" stroke-width="2" fill="none"/>
                <rect  class="output-leaf" x="420" y="150" height="50" width="100" stroke="blue" stroke-width="2" fill="none"/>-->
        </g>

        </svg>
        <p class="coors"></p>
        <div class="linedemo"></div>





        <script>
//The data for our line
            var lineData = [{"x": 1, "y": 5}, {"x": 150, "y": 80}];

//This is the accessor function we talked about above
            var lineFunction = d3.line()
                    .x(function (d) {
                        return d.x;
                    })
                    .y(function (d) {
                        return d.y;
                    });
//                    .curve(d3.curveLinear(0.5));

//The SVG Container
            var svgContainer = d3.select(".linedemo").append("svg")
                    .attr("width", 200)
                    .attr("height", 200);

//The line SVG Path we draw
            var lineGraph = svgContainer.append("path")
                    .attr("d", lineFunction(lineData))
                    .attr("stroke", "blue")
                    .attr("stroke-width", 2)
                    .attr("fill", "none");

            var pbox = d3.select(".coors");







            var inputs = [{"text": "inleaf1", "col": "red"}, {"text": "inleaf2", "col": "blue"}, {"text": "inleaf3", "col": "green"}];
            var outputs = [{"text": "outleaf1", "col": "red"}, {"text": "outleaf2", "col": "blue"}, {"text": "outleaf3", "col": "green"}];

            var elementwidth = 120;
            var elementheight = 50;
            var inputstartx = 20;
            var inputstarty = 20; ///////////y should change for each rectangle
            var verticalmargin = 20;

            var canvas = d3.select(".canvas");
            var inputcontainer = d3.select("#input-container");


            var coordinates, dragdot2, dragline, xx, yy;
            var dragme = d3.drag()
                    .on("start", function (d) {
                        xx = 0;
                        yy = 0;
                        coordinates = [0, 0];
                        dragdot2 = canvas.append("svg:circle")
                                .attr("cx", function (d) {
                                    return inputstartx + elementwidth;
                                })
                                .attr("cy", function (d, i) {
                                    return inputstarty + (elementheight / 2) + ((elementheight + verticalmargin) * i);
                                })
                                .attr("r", function () {
                                    return elementheight / 4;
                                })
                                .attr("fill", "black");
                        dragline = canvas.append("svg:line")
                                .attr("x1", function (d) {
                                    return inputstartx + elementwidth;
                                })
                                .attr("x2", function (d) {
                                    return inputstartx + elementwidth;
                                })
                                .attr("y1", function (d, i) {
                                    return inputstarty + (elementheight / 2) + ((elementheight + verticalmargin) * i);
                                })
                                .attr("y2", function (d, i) {
                                    return inputstarty + (elementheight / 2) + ((elementheight + verticalmargin) * i);
                                })
                                .style("stroke", "rgb(0,150,150)")
                                .style("stroke-width", "2");
                    })
                    .on("drag", function (d) {
                        coordinates = d3.mouse(this);
                        xx = coordinates[0];
                        yy = coordinates[1];
                        dragline.attr("x2", xx).attr("y2", yy);
                        dragdot2.attr("cx", xx).attr("cy", yy);

                        //if position is inside the outleafs - stroke color change
                    })
                    .on("end", function (d) {
                        d3.select(".coors").text(xx + "-" + yy);
                        //if position is inside the outleafs - set position to the left of the rect
                    });



            var inputleaf = inputcontainer.selectAll("rect")
                    .data(inputs)
                    .enter().append("rect")
                    .attr("class", "input-leaf")
                    .attr("width", elementwidth)
                    .attr("height", elementheight)
                    .attr("x", inputstartx)
                    .attr("y", function (d, i) {
                        return inputstarty + ((elementheight + verticalmargin) * i);
                    })
                    .attr("stroke-width", "2")
                    .attr("fill", "none")
                    .attr("stroke", function (d) {
                        return d.col;
                    });

            var inputtext = inputcontainer.selectAll("text")
                    .data(inputs)
                    .enter().append("text")
                    .attr("x", inputstartx + 5)
                    .attr("y", function (d, i) {
                        return inputstarty + (elementheight / 2) + ((elementheight + verticalmargin) * i);
                    })
                    .text(function (d) {
                        return d.text;
                    });




            var inputdragdot = inputcontainer.selectAll("circle")
                    .data(inputs)
                    .enter().append("circle")
                    .attr("class", "dragme")
                    .attr("cx", function (d) {
                        return inputstartx + elementwidth;
                    })
                    .attr("cy", function (d, i) {
                        return inputstarty + (elementheight / 2) + ((elementheight + verticalmargin) * i);
                    })
                    .attr("r", function () {
                        return elementheight / 4;
                    })
                    .attr("fill", "black")
                    .call(dragme);




            // dragdot1.call(dragme);

        </script>


    </body>

</html>